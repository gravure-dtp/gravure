<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title>Debian repository</title>
		<meta name='Generator' content='Zim 0.56'>
		
		<link rel="stylesheet" href='../../../_resources/style.css' type="text/css"
        media="screen" />
		
		<style type='text/css'>
			span.insen { color: grey                }
			.menu{

			}
		
			.notebook{font-variant: small-caps;
					color:#4e9a06;
					padding: 0px 20px;}
			hr{clear:both;}
		</style>
		
	</head>
	<body>
	    <div class="header">
	    <div class="status">
	        <th1>-</th1>
	    </div>
	    </div>
	    
	    <div class="header">
            <div class="logo">
                <img src='../../../_resources/logo.png' alt="logo" />
            </div>
            <div class="title"><small>Documentations : Debian repository</small></div>
            </br>
        </div>
            
        <div class="mainmenu">
        <th1>
            <a href='../../../../index.html'>Home</a>
            <a href='../../../../doc/trunk/www/GRAVURE.txt'>Documentation</a>
            <a href='../../../../timeline'>Timeline</a>
            <a href='../../../../dir?ci=tip'>Code</a>
            <a href='../../../../brlist'>Branches</a>
            <a href='../../../../taglist'>Tags</a>
            <a href='../../../../reportlist'>Tickets</a>
            <a href='../../../../wiki'>Wiki</a>
        </th1></div>     
            
        <div class="container">    
			<div class="heading span-6">
				
			</div>
 
			<div class="menu span-2">
				<ul>
<li><a href="../../../FOSSIL_REPOSITORY.html" title="FOSSIL REPOSITORY">FOSSIL REPOSITORY</a></li>
<li><a href="../../../GRAPHIC_LIBRARY.html" title="GRAPHIC LIBRARY">GRAPHIC LIBRARY</a></li>
<li><a href="../../../GRAVURE.html" title="GRAVURE">GRAVURE</a></li>
<ul>
<li><a href="../../COLOR_MANAGMENT.html" title="COLOR MANAGMENT">COLOR MANAGMENT</a></li>
<li><a href="../../GRAVURE_GHOSCRIPT_DEVICE.html" title="GRAVURE GHOSCRIPT DEVICE">GRAVURE GHOSCRIPT DEVICE</a></li>
<li><a href="../../IMPOSITION.html" title="IMPOSITION">IMPOSITION</a></li>
<li><a href="../../POSTSCRIPT.html" title="POSTSCRIPT">POSTSCRIPT</a></li>
<li><a href="../../PYTHON.html" title="PYTHON">PYTHON</a></li>
<li><a href="../../scenario_CMM.html" title="scenario CMM">scenario CMM</a></li>
<li><a href="../../VUE_GENERALE.html" title="VUE GENERALE">VUE GENERALE</a></li>
<ul>
<li><a href="../id%C3%A9e_de_distribution.html" title="idée de distribution">idée de distribution</a></li>
<li><a href="../PACKAGING_%26_DISTRIBUTION.html" title="PACKAGING &amp; DISTRIBUTION">PACKAGING &amp; DISTRIBUTION</a></li>
<ul>
<li><a href="./Debian_Packaging.html" title="Debian Packaging">Debian Packaging</a></li>
<li><strong>Debian repository</strong></li>
<li><a href="./ghostscript.html" title="ghostscript">ghostscript</a></li>
<li><a href="./Nemo.html" title="Nemo">Nemo</a></li>
<li><a href="./ToDo.html" title="ToDo">ToDo</a></li>
</ul>
<li><a href="../PRINTING.html" title="PRINTING">PRINTING</a></li>
</ul>
</ul>
<li><a href="../../../TRC.html" title="TRC">TRC</a></li>
</ul>

			</div>
			
			
			<div class="content span-4 last">
			<!-- Wiki content -->
				<p>
Created lundi 31 décembre 2012<br>
</p>

<h3>Debian repository</h3>
<p>
<a href="http://wiki.debian.org/SettingUpSignedAptRepositoryWithReprepro" title="http://wiki.debian.org/SettingUpSignedAptRepositoryWithReprepro">http://wiki.debian.org/SettingUpSignedAptRepositoryWithReprepro</a><br>
<a href="http://wiki.debian.org/HowToSetupADebianRepository" title="http://wiki.debian.org/HowToSetupADebianRepository">http://wiki.debian.org/HowToSetupADebianRepository</a><br>
<a href="http://www.isotton.com/software/debian/docs/repository-howto/repository-howto.html" title="http://www.isotton.com/software/debian/docs/repository-howto/repository-howto.html">http://www.isotton.com/software/debian/docs/repository-howto/repository-howto.html</a><br>
<a href="http://dthconnex.com/debian_repository.htm" title="http://dthconnex.com/debian_repository.htm">http://dthconnex.com/debian_repository.htm</a><br>
</p>

<p>
<a href="http://blog.jonliv.es/2011/04/26/creating-your-own-signed-apt-repository-and-debian-packages/" title="Creating your own Signed APT Repository and Debian Packages:">Creating your own Signed APT Repository and Debian Packages:</a><br>
</p>

<h3>Mise en place du de l'apt repository</h3>

<p>
<ul>
<li>génération d'une clé gpg pour la signature du catalogue du serveur</li>
<li>export de la clé complète et copie par scp sur le serveur</li>
<li>import gpg de la clé, puis effacement de la clé</li>
<li>creation d'un volume lvm apt</li>
<li>montage sur <a href="../../../../../../../../../apt" title="/apt">/apt</a> et bind sur /srv/apache/var/www/apt</li>
<li>création des répertoires </li>
<ul>
<li>/apt/debian</li>
<li>/apt/debian/conf</li>
<li>/apt/debian/tmp</li>
<li>/apt/debian/log</li>
<li>/apt/debian/morgue</li>
<li>/apt/debian/incoming</li>
</ul>
<li>chown serverobscur -R sur /apt/debian</li>
<li>instalation de reprepro</li>
<li>édition de <a href="../../../../../../../../../etc/apache2/sites-available/default%2C" title="/etc/apache2/sites-available/default,">/etc/apache2/sites-available/default,</a> ajout d'un virtual host</li>
</ul>
   et de <a href="../../../../../../../../../etc/apache2/ports.confs" title="/etc/apache2/ports.confs">/etc/apache2/ports.confs</a> ajout d'un listen pour le virtual host<br>
<ul>
<li>édition de <a href="../../../../../../../../../etc/shorewall/rules" title="/etc/shorewall/rules">/etc/shorewall/rules</a></li>
<li>création de apt/debian/conf/distribution, options, release.override, incoming conf files</li>
<li>export de la clef public sur le serveur :</li>
</ul>
<div style='padding-left: 30pt'>
<code>gpg --armor --output dev@atelierobscur.org.gpg.key --export dev@atelierobscur.org</code><br>
</div>
</p>


<h4>signature automatique</h4>
<p>
<ul>
<li>sur <a href="http://openpgp.vie-privee.org/gnupg-faq-fr.html" title="http://openpgp.vie-privee.org/gnupg-faq-fr.html">http://openpgp.vie-privee.org/gnupg-faq-fr.html</a> un tuto que je comprends pas pour créer une cléf de signature sans passphrase</li>
<li>gnupg-agent a trop de dependance, pas envie de l'installer sur le serveur</li>
<li>donc pour le moment apt/debian/conf/option contient ask-passphrase</li>
</ul>
</p>

<h4>automatique incoming</h4>
<p>
<ul>
<li>pas d'automatisme pour l'instant, posibilité par cron ou par <a href="http://packages.debian.org/inoticoming" title="inoticoming">inoticoming</a> (pas clair) - <a href="http://man.devl.cz/man/1/inoticoming" title="http://man.devl.cz/man/1/inoticoming">http://man.devl.cz/man/1/inoticoming</a></li>
</ul>
</p>

<h4>déclencher processincoming</h4>

<p>
<ul>
<li>copy par scp dans /apt/debian/incoming/</li>
<li>connection ssh au serveur et cd <a href="../../../../../../../../../apt/debian" title="/apt/debian">/apt/debian</a></li>
<li>reprepro processincoming wheezy</li>
</ul>
</p>

<h4>output</h4>

<p>
<strike>./conf/options:3: Ignoring too long (or incomplete) line.</strike><br>
<strike>Warning parsing config file '/apt/debian/conf/incoming', line '6': File ending without final LF!</strike><br>
<strike>Warning: There is a 'MorgueDir' but no 'Cleanup' to act on in rule 'wheezy'</strike><br>
<strike>Could not check validity of signature with 'EC9B72AB82C29938' in 'nemo_1.1.2-rc1_amd64.changes' as</strike> <strike>public key missing!</strike><br>
<strike>Missing line terminator in 'override.wheezy'!</strike><br>
<strike>Missing line terminator in 'override.wheezy'!</strike><br>
<strike>gpgme gave error GPGME:11:  Bad passphrase</strike><br>
</p>




			<!-- End wiki content -->
			</div>
			
			
			<!-- Backlinks -->
			<div class="span-8 last">
			    <hr>>
				Backlinks:
			<!-- End Backlinks -->
			</div>
        </div>
        <div class="footer">
            Fossil version 1.22
        </div>
</body></html>
	</body>
</html>
